!function(){function t(t){k.push(t),store.set("gg",k)}function e(){var t=$(".task-list");t.html(null);for(var e=[],a=0;a<k.length;a++)k[a].complete?((s=n(k[a],a)).addClass("complated"),t.prepend(s)):e[a]=k[a];for(var c=0;c<e.length;c++)if(e[c]){var s=n(e[c],c);t.prepend(s),p(s)}i(),l(),m()}function n(t,e){var n='<li data-index="'+e+'"><input type="checkbox" class="complete" '+(t.complete?"checked":"")+'><p class="content">'+t.content+'</p><div class="right"><span class="delete r-main">删除</span><span class="detail r-main">详细</span></div></li>';return $(n)}function i(){$(".delete.r-main").click(function(){a($(this).parent().parent().data("index"))})}function a(t){$(".Alert").show(),$(".primary.confirm").bind("click",function(){$(".Alert").hide(),k.splice(t,1),c(),$(".primary.confirm").unbind("click")}),$(".cancel").click(function(){$(".Alert").hide(),$(".primary.confirm").unbind("click")})}function c(){store.set("gg",k),e()}function l(){$(".detail.r-main").click(function(){var t=$(this).parent().parent().data("index");s(k[t],t)})}function s(t,e){str='<div class="task-detail-mask"></div><div class="task-detail"><form class="up-task"><h2 class="content">'+(t.content||"")+'</h2><div class="input-item"><input type="text" class="title-input"></div><div class="input-item"><textarea class="detailtext">'+(t.detail||"")+'</textarea></div><div class="remind input-item"><label for="b">提醒时间</label><input class="datetime" id="datetimepicker" type="text" value="'+(t.datetime||"")+'"></div><div class="input-item"><button class="update-detail-btn">更新</button></div><div class="colse">x</div></form></div></div>',$(".container").append(str),$("#datetimepicker").datetimepicker(),$.datetimepicker.setLocale("ch"),o(),d(t,e),u()}function o(){$(".task-detail-mask,.colse").click(function(){$(".task-detail-mask,.task-detail").remove()})}function d(t,n){$(".up-task").on("submit",function(t){t.preventDefault();var i={};i.content=$(this).find(".content").text(),i.detail=$(this).find(".detailtext").val(),i.datetime=$(this).find(".datetime").val(),r(i,n),$(".task-detail-mask,.task-detail").remove(),e()})}function r(t,e){k[e]=$.extend({},k[e],t),store.set("gg",k)}function u(){var t=$(".up-task .content");t.on("dblclick",function(){var e=$(".title-input");t.hide(),e.val(t.text()),e.show(),e.focus(),e.on("blur",function(){t.show(),e.hide(),e.val()&&t.text(e.val())})})}function m(){$(".task-list .complete").click(function(){var t=$(this).parent().data("index");k[t].complete?r({complete:!1},t):r({complete:!0},t),e()})}function p(t){$(t)[0]&&(clearInterval($(t)[0].timer),$(t)[0].timer=setInterval(function(){for(var e=(new Date).getTime(),n=k,i=0;i<n.length;i++)n[i].complete||!n[i].datetime||n[i].off||new Date(n[i].datetime).getTime()-e<=1&&(clearInterval($(t)[0].timer),v(),f(k[i],i))},1e3))}function f(t,e){$(".msg").show(),$(".msg-content").text(t.content),$(".msg-btn").click(function(){r({off:!0},e),$(".msg").hide()})}function v(){document.getElementById("music").play()}var k=[],h=$(".add-task");k=store.get("gg")||[],e(),h.on("submit",function(n){n.preventDefault();var i={};i.content=h.find("input").eq(0).val(),i.content&&(t(i),e(),h.find("input").eq(0).val(null))})}(),console.log(2);